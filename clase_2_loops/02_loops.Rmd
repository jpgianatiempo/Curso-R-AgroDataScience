---
title: "Loops: for / if / while"
output:
  html_notebook:
    toc: yes
    toc_float: yes
date: ""
subtitle: "Curso: R para el análisis de datos en el agro"
author: "Bolsa de Cereales"
---

### ¿Qué es un loop?
En esta clase vamos a aprender a escribir los códigos básicos para hacer loops en R. Como es un curso inicial, esta preparado para personas que no están familiarizadas con la sintáxis básica de R.

Conceptualmente, un loop es una forma de repetir una secuencia de instrucciones en determinadas condiciones. Permiten automatizar partes del código que necesitan repetirse. ¿Suena raro? No se preocupen, se volverá más claro una vez que comencemos a trabajar con algunos ejemplos a continuación.

Antes de sumergirse en la escritura de loops en R, hay una cosa importante que deben saber. Al navegar por la web, a menudo leerá que se debe evitar el uso de loops en R. ¿Por qué? Bueno, eso se debe a que R admite la vectorización. En pocas palabras, esto permite cálculos mucho más rápidos. Por ejemplo, las soluciones que utilizan loops son menos eficientes que las soluciones vectorizadas que utilizan funciones de aplicación, como __lapply__ y __sapply__. A menudo es mejor utilizar este último. Sin embargo, como principiante en R, es bueno tener un conocimiento básico de los loops y cómo escribirlos.


### For loop en R

Volvamos al significado conceptual de un loop. Supongamos que deseamos hacer varias impresiones de la siguiente forma: Este año es [año], donde [año] es igual a 2015, 2016, hasta 2020. Esto puede hacerse de la siguiente manera:

```{r}
print(paste("Este año es", 2015))

print(paste("Este año es", 2016))

print(paste("Este año es", 2017))

print(paste("Este año es", 2018))

print(paste("Este año es", 2019))

print(paste("Este año es", 2020))

```

Inmediatamente se puede observar que esto es bastante tedioso: repite el mismo fragmento de código una y otra vez. En este caso, al hacer uso de un loop for en R, puede automatizar la parte repetitiva:

```{r}
for (año in c(2015,2016,2017,2018,2019,2020)){
  print(paste("Este año es", año))
}

```

La mejor manera de entender lo que está sucediendo en el loop _for_ es leerlo de la siguiente manera: “Para cada año que está en la secuencia `c (2015,2016,2017,2018,2019,2020)`, ejecuta el código chunk `print (paste ("Este año es", año))`. Una vez que el loop _for_ ha ejecutado el fragmento de código para cada año en el vector, el ciclo se detiene y pasa a la primera instrucción después del bloque del ciclo.

Al usar un loop _for_, solo necesita escribir su fragmento de código una vez (en lugar de seis veces). El ciclo for luego ejecuta la declaración una vez para cada valor proporcionado (los diferentes años que proporcionamos) y establece la variable (año en este caso) en ese valor. Incluso puede simplificar el código aún más escribiendo `2010: 2015`.

```{r}
for (año in 2015:2020){
  print(paste("Este año es", año))
}

```



#### Excel 


Para leer y escribir archivos excel podemos utilizar los comandos que vienen con la librería _openxlsx_ o _readxl_.

```{r}
#Para leer archivos en formato RDS, se puede utilizar la siguiente función:

#de R Base
readRDS()

#de readr
read_rds()

#Para grabar los archivos usar:
write_rds()

```
